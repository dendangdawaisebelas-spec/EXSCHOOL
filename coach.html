<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Coach Dashboard - EXSCHOOL</title>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    :root { 
      --navy: #0a1f44; 
      --gold: #bf953f; 
      --light-bg: #fcfcfc;
      --card-shadow: 0 10px 30px rgba(0,0,0,0.04);
    }

    body { 
      font-family: 'Plus Jakarta Sans', sans-serif; 
      margin: 0; background-color: var(--light-bg); 
      padding-bottom: 50px; color: #333;
    }

    header { 
      background: #ffffff; padding: 30px 20px; text-align: center;
      border-bottom: 1px solid #eee; position: sticky; top: 0; z-index: 100;
      animation: fadeInDown 0.8s ease-out;
      display: flex; flex-direction: column; align-items: center;
    }

    @keyframes fadeInDown {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    #ekskul-icon {
        width: 40px; height: 40px; object-fit: contain; margin-bottom: 10px;
        animation: iconBounce 1s ease-out;
    }

    @keyframes iconBounce {
        from { opacity: 0; transform: translateY(-20px) scale(0.5); }
        to { opacity: 1; transform: translateY(0) scale(1); }
    }

    #dynamic_title { 
      margin: 0; font-size: 22px; text-transform: uppercase; 
      letter-spacing: 2px; font-weight: 800; color: var(--navy);
    }

    .icms-badge { 
      background: var(--gold); color: white; padding: 6px 20px; 
      border-radius: 50px; font-size: 11px; font-weight: 700; 
      margin-top: 12px; display: inline-block; text-transform: uppercase;
    }

    .btn-action { 
      width: calc(100% - 40px); margin: 15px 20px 5px 20px; padding: 16px; 
      border: none; border-radius: 15px; font-weight: 800; text-transform: uppercase;
      font-size: 13px; cursor: pointer; transition: 0.3s; display: flex;
      align-items: center; justify-content: center; gap: 10px;
    }

    .btn-diskusi { background: var(--navy); color: white; position: relative; box-shadow: 0 10px 20px rgba(10,31,68,0.15); }
    .btn-kaldik { background: #8e44ad; color: white; }

    .notif-dot { position: absolute; top: -4px; right: -4px; width: 14px; height: 14px; background-color: #ff4757; border: 3px solid white; border-radius: 50%; display: none; }
    .pulse { animation: pulse-red 2s infinite; }
    @keyframes pulse-red { 0% { transform: scale(0.95); } 70% { transform: scale(1.1); box-shadow: 0 0 0 10px rgba(255, 71, 87, 0); } 100% { transform: scale(0.95); } }

    .card { 
      background: #ffffff; padding: 25px; border-radius: 24px; 
      margin: 20px; box-shadow: var(--card-shadow); 
      border: 1px solid #f0f0f0; animation: fadeInUp 0.8s ease-out both;
    }

    @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

    h3 { font-size: 16px; font-weight: 800; color: var(--navy); margin-top: 0; border-bottom: 2px solid #f8f9fa; padding-bottom: 10px; }
    label { font-weight: 700; display: block; margin-top: 15px; color: #888; font-size: 11px; text-transform: uppercase; }
    
    textarea, input { 
      width: 100%; padding: 14px; margin-top: 8px; border-radius: 12px; 
      border: 1.5px solid #f0f0f0; background: #fafafa; box-sizing: border-box; 
      font-family: inherit; font-size: 14px; transition: 0.3s;
    }

    textarea::placeholder, input::placeholder {
        color: #b0b0b0; /* Warna placeholder */
        font-style: italic; /* Gaya italic */
    }

    textarea:focus, input:focus { border-color: var(--navy); background: #fff; outline: none; }

    .btn-save { background: #2f3542; color: white; border: none; padding: 16px; width: 100%; border-radius: 12px; font-weight: 800; cursor: pointer; margin-top: 15px; text-transform: uppercase; font-size: 12px; }
    .btn-save:hover { background: var(--navy); }

    #sList { margin-top: 15px; }
    .siswa-item { display: flex; align-items: center; gap: 10px; padding: 10px; border-bottom: 1px solid #f8f9fa; font-size: 14px; }
    .siswa-item input[type="checkbox"] { width: auto; margin: 0; }
  </style>
</head>
<body>

<header>
  <img id="ekskul-icon" src="" alt="Icon Ekskul" style="display:none;"> <h1 id="dynamic_title">MEMUAT...</h1>
  <div class="icms-badge">SMP-SMA ICMS</div>
  <div id="cName" style="font-size:11px; color:#888; margin-top:8px; font-weight:600;"></div>
</header>

<button class="btn-action btn-diskusi" onclick="window.location.href='diskusi.html'">
  <i class="fa-solid fa-comments"></i> BUKA RUANG DISKUSI (GRUP)
  <span id="dot" class="notif-dot pulse"></span>
</button>

<button class="btn-action btn-kaldik" onclick="bukaJadwalKaldik()">
  <i class="fa-solid fa-calendar-alt"></i> JADWAL EKSKUL & KALDIK
</button>

<div class="card" style="animation-delay: 0.2s;">
  <h3>1. Input Pertemuan Harian</h3>
  <label>Tanggal Pertemuan</label>
  <input type="date" id="tgl">
  <label>Materi Latihan</label>
  <textarea id="mat" rows="2" placeholder="Contoh: Pengenalan dasar Taekwondo & PBB. Fokus pada kuda-kuda dasar dan hormat."></textarea>
  <label>Keterangan Khusus</label>
  <input type="text" id="als_harian" placeholder="Contoh: 2 siswa izin karena sakit. Siswa perpulangan: [Nama Siswa]">
  <button class="btn-save" style="background:#2980b9" onclick="simpanPertemuan()">SIMPAN PERTEMUAN</button>
</div>

<div class="card" style="animation-delay: 0.4s;">
  <h3>2. Laporan Evaluasi Bulanan</h3>
  <p style="font-size: 11px; color: #eb4d4b; font-weight:bold; margin-bottom:15px;">*Wajib diisi setiap akhir bulan sebagai bahan laporan.</p>
  
  <label>Agenda Terlaksana</label><textarea id="eval_agenda" rows="2" placeholder="Contoh: Latihan rutin 4x/bulan, Ujian Kenaikan Tingkat, Persiapan lomba 'ICMS Cup'."></textarea>
  <label>Capaian Siswa</label><textarea id="eval_capaian" rows="2" placeholder="Contoh: 80% siswa sudah menguasai gerakan dasar. 5 siswa berhasil naik tingkat."></textarea>
  <label>Kendala</label><textarea id="eval_kendala" rows="2" placeholder="Contoh: Keterlambatan beberapa siswa, ketersediaan alat musik terbatas."></textarea>
  <label>Solusi</label><textarea id="eval_solusi" rows="2" placeholder="Contoh: Sosialisasi ulang jadwal, pengajuan penambahan alat."></textarea>
  <label>Saran ke Depan</label><textarea id="eval_saran" rows="2" placeholder="Contoh: Perlu jadwal latihan tambahan untuk siswa yang akan lomba."></textarea>
  
  <button class="btn-save" style="background:#1c7c54" onclick="simpanEvaluasi()">UPDATE EVALUASI BULANAN</button>
</div>

<div class="card" style="animation-delay: 0.6s;">
  <h3>3. Presensi Siswa</h3>
  <div id="sList"></div>
</div>

<script>
  const eks = localStorage.getItem("ekskul") || "Ekskul";
  const user = localStorage.getItem("username") || "User";

  function setHeader() {
    const titleEl = document.getElementById("dynamic_title");
    const iconEl = document.getElementById("ekskul-icon");
    document.getElementById("cName").innerText = "PELATIH: " + user.toUpperCase();
    
    let iconSrc = "";
    if (eks === "Nihongo Club") {
        titleEl.innerText = "日本語教師";
        iconSrc = "japan_flag.png"; // Nama file ikon
    } else if (eks === "Musik") {
        titleEl.innerText = "Instruktur Musik";
        iconSrc = "music_note.png"; // Nama file ikon
    } else if (eks === "Dokter Kecil") {
        titleEl.innerText = "Instruktur Dokter Kecil";
        iconSrc = "stetoskop.png"; // Nama file ikon
    } else if (eks === "English Club") {
        titleEl.innerText = "English Club Teacher";
        iconSrc = "uk_flag.png"; // Nama file ikon
    } else if (eks === "Taekwondo") {
        titleEl.innerText = "Sabeum Taekwondo";
        iconSrc = "taekwondo_icon.png"; // Nama file ikon
    } else if (eks === "Pramuka") {
        titleEl.innerText = "Pembina Pramuka";
        iconSrc = "pramuka_badge.png"; // Nama file ikon
    } else if (eks === "Futsal") {
        titleEl.innerText = "Coach Futsal";
        iconSrc = "futsal_ball.png"; // Nama file ikon
    } else if (eks === "Basket") {
        titleEl.innerText = "Coach Basket";
        iconSrc = "basketball_icon.png"; // Nama file ikon
    } else if (eks === "Panahan") {
        titleEl.innerText = "Coach Panahan";
        iconSrc = "archery_icon.png"; // Nama file ikon
    } else if (eks === "Renang") {
        titleEl.innerText = "Coach Renang";
        iconSrc = "swimming_icon.png"; // Nama file ikon
    } else if (eks === "Badminton") {
        titleEl.innerText = "Coach Badminton";
        iconSrc = "badminton_icon.png"; // Nama file ikon
    }
    else {
        titleEl.innerText = "COACH " + eks.toUpperCase();
    }

    if (iconSrc) {
        iconEl.src = iconSrc;
        iconEl.style.display = "block"; // Tampilkan ikon jika ada sumber
    } else {
        iconEl.style.display = "none";
    }
  }

  const sListEl = document.getElementById("sList");
  const siswa = JSON.parse(localStorage.getItem("siswa_" + eks)) || [];
  if(siswa.length === 0) {
    sListEl.innerHTML = "<p style='color:#999; font-size:12px;'>Belum ada data siswa terdaftar.</p>";
  } else {
    siswa.forEach(n => { 
      sListEl.innerHTML += `<div class="siswa-item"><input type="checkbox" class="c" checked> <span>${n}</span></div>`; 
    });
  }

  function simpanPertemuan() {
    const tgl = document.getElementById("tgl").value; 
    const mat = document.getElementById("mat").value;
    if(!tgl || !mat) return alert("Isi Tanggal & Materi!");
    
    let db = JSON.parse(localStorage.getItem("data_" + eks)) || [];
    db.push({ tgl, mat, ket: document.getElementById("als_harian").value });
    localStorage.setItem("data_" + eks, JSON.stringify(db));
    alert("Data Pertemuan Disimpan!");
  }

  function simpanEvaluasi() {
    const evalData = {
      agenda: document.getElementById("eval_agenda").value,
      capaian: document.getElementById("eval_capaian").value,
      kendala: document.getElementById("eval_kendala").value,
      solusi: document.getElementById("eval_solusi").value,
      saran: document.getElementById("eval_saran").value
    };
    localStorage.setItem("eval_" + eks, JSON.stringify(evalData));
    alert("Laporan Bulanan Berhasil Diperbarui!");
  }

  function bukaJadwalKaldik() {
    const modal = document.createElement("div");
    modal.style.cssText = "position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); z-index:9999;
